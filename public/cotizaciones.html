<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nueva Cotización</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="js/cotizaciones.js"></script>
  <link rel="stylesheet" href="styles/cotizaciones.css">
  <style>
    /* Add this to center the modal */
    #modal-categorias {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="main-header">
      <h1 class="main-title">Nueva Cotización</h1>
      <p class="main-subtitle">Sigue los pasos para crear tu cotización</p>
      
      <div class="step-indicator">
        <div class="step-number">1</div>
      </div>
      
      <div class="step-title">Paso 1: Selección de Tipo</div>
      <div class="step-description">¿Qué tipo de cotización deseas crear?</div>
    </div>

    <div class="stats-cards">
      <div class="stat-card blue">
        <div class="stat-icon">
          <i class="fa-solid fa-calendar"></i>
        </div>
        <div class="stat-label">Rentas Activas</div>
        <div class="stat-number">45</div>
      </div>
      
      <div class="stat-card green">
        <div class="stat-icon">
          <i class="fa-solid fa-chart-line"></i>
        </div>
        <div class="stat-label">Ventas del Mes</div>
        <div class="stat-number">12</div>
      </div>
      
      <div class="stat-card orange">
        <div class="stat-icon">
          <i class="fa-solid fa-tools"></i>
        </div>
        <div class="stat-label">Servicios Pendientes</div>
        <div class="stat-number">8</div>
      </div>
    </div>

    <div class="quote-type-cards">
      <div class="quote-type-card blue" id="renta-card" data-type="renta" style="cursor:pointer;">
        <div class="quote-icon">
          <i class="fa-solid fa-calendar"></i>
        </div>
        <h3 class="quote-title">Renta</h3>
        <p class="quote-subtitle">Alquiler de equipos por tiempo determinado</p>
        
        <ul class="quote-features">
          <li><i class="fa-solid fa-check"></i> Período flexible</li>
          <li><i class="fa-solid fa-check"></i> Entrega incluida</li>
          <li><i class="fa-solid fa-check"></i> equipos de calidad </li>
        </ul>
        
        <div class="quote-stats">
          <div class="quote-stat">
            <div class="quote-stat-label">Activas</div>
            <div class="quote-stat-number">45</div>
          </div>
        </div>
        
        <button class="quote-action-btn" id="open-modal-btn" type="button">
          Seleccionar Renta →
        </button>
      </div>

      <div class="quote-type-card green" id="venta-card" data-type="venta">
        <div class="quote-icon">
          <i class="fa-solid fa-shopping-cart"></i>
        </div>
        <h3 class="quote-title">Venta</h3>
        <p class="quote-subtitle">Compra directa de equipos</p>
        
        <ul class="quote-features">
          <li><i class="fa-solid fa-check"></i> Propiedad total</li>
          <li><i class="fa-solid fa-check"></i> Garantía incluida</li>
          <li><i class="fa-solid fa-check"></i> Financiamiento</li>
        </ul>
        
        <div class="quote-stats">
          <div class="quote-stat">
            <div class="quote-stat-label">Este mes</div>
            <div class="quote-stat-number">12</div>
          </div>
        </div>
        
        <button class="quote-action-btn" id="open-modal-btn" type="button">
          Seleccionar Venta →
        </button>
      </div>

      <div class="quote-type-card orange" data-type="servicio">
        <div class="quote-icon">
          <i class="fa-solid fa-tools"></i>
        </div>
        <h3 class="quote-title">Servicio</h3>
        <p class="quote-subtitle">Servicios especializados</p>
        
        <ul class="quote-features">
          <li><i class="fa-solid fa-check"></i> Capacitación</li>
          <li><i class="fa-solid fa-check"></i> Inspección</li>
          <li><i class="fa-solid fa-check"></i> Certificación</li>
        </ul>
        
        <div class="quote-stats">
          <div class="quote-stat">
            <div class="quote-stat-label">Pendientes</div>
            <div class="quote-stat-number">8</div>
          </div>
        </div>
        
        <button class="quote-action-btn" onclick="selectQuoteType('servicio')">
          Seleccionar Servicio →
        </button>
      </div>
    </div>
  </div>
  <!-- Modal de Categorías para Renta -->
  <div id="modal-categorias" hidden style="position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.45); z-index:1000;">
    <div style="background:#fff; width:min(960px, 92vw); border-radius:14px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.2);">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
        <h2 style="margin:0; font-size:20px;">Categorías</h2>
        <button type="button" id="close-modal-btn" style="border:0; background:#eee; border-radius:8px; padding:6px 10px; cursor:pointer;">Volver</button>
      </div>
      <p style="margin-top:0; color:#475569;">Elige una categoría para continuar con la renta.</p>
      <div class="modal-content" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:12px;">
        <div style="border:1px solid #e2e8f0; border-radius:12px; padding:14px; background:#f8fafc;">
          <h3 style="margin:0 0 8px;">Marco y cruceta</h3>
          <p style="margin:0 0 12px; color:#64748b;">Sistema marco-cruceta (Módulo 200, 150, 100)</p>
          <button type="button" data-cat="marco_cruceta" class="modal-option" style="border:0; background:#2563eb; color:#fff; padding:10px 12px; border-radius:10px; cursor:pointer; width:100%; font-weight:600;">Seleccionar</button>
        </div>
        <div style="border:1px solid #e2e8f0; border-radius:12px; padding:14px; background:#f8fafc;">
          <h3 style="margin:0 0 8px;">Multidireccional</h3>
          <p style="margin:0 0 12px; color:#64748b;">Componentes y uniones multidireccionales</p>
          <button type="button" data-cat="multidireccional" class="modal-option" style="border:0; background:#2563eb; color:#fff; padding:10px 12px; border-radius:10px; cursor:pointer; width:100%; font-weight:600;">Seleccionar</button>
        </div>
        <div style="border:1px solid #e2e8f0; border-radius:12px; padding:14px; background:#f8fafc;">
          <h3 style="margin:0 0 8px;">Templetes</h3>
          <p style="margin:0 0 12px; color:#64748b;">Plataformas y elementos para templetes</p>
          <button type="button" data-cat="templetes" class="modal-option" style="border:0; background:#2563eb; color:#fff; padding:10px 12px; border-radius:10px; cursor:pointer; width:100%; font-weight:600;">Seleccionar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const modal = document.getElementById('modal-categorias');
      const openBtn = document.getElementById('open-modal-btn');
      const rentaCard = document.getElementById('renta-card');
      const ventaCard = document.getElementById('venta-card'); 
      const closeBtn = document.getElementById('close-modal-btn');
      const content = document.querySelector('.modal-content');
      const selects = () => Array.from(document.querySelectorAll('.modal-option'));

      let modalMode = null; 

      function openModal(mode) {
        modalMode = mode;
        modal.removeAttribute('hidden');
        modal.style.display = 'flex';
      }
      function closeModal(){
        modal.setAttribute('hidden', '');
        modal.style.display = 'none';
        modalMode = null;
      }
      function go(cat) {
        if (modalMode === 'renta') {
          window.location.href = `cotizacion_renta.html?categoria=${encodeURIComponent(cat)}`;
        } else if (modalMode === 'venta') {
          window.location.href = `cotizacion_venta.html?categoria=${encodeURIComponent(cat)}`;
        }
      }

      openBtn?.addEventListener('click', (e) => { e.stopPropagation(); openModal('renta'); });
      rentaCard?.addEventListener('click', () => openModal('renta'));
      ventaCard?.addEventListener('click', () => openModal('venta')); 
      closeBtn?.addEventListener('click', closeModal);
      modal?.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
      content?.addEventListener('click', (e) => { e.stopPropagation(); });
      selects().forEach(btn => btn.addEventListener('click', () => go(btn.getAttribute('data-cat'))));

      closeModal();
    })();
  </script>
</body>
</html>